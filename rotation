#include<stdio.h>
#include<GL/glut.h>
#include<math.h>
#include<stdlib.h>
int v,i,j,k;

float input[3][10],output[3][10],tr[3][3],scale[3][3],rotate[3][3],ref[3][3];
int xa,ya,xb,yb;

void mul(float input[3][10],float output [3][10],float rotate[3][3],int v){
	for(i=0;i<3;i++){
		for(j=0;j<v;j++){
			output[i][j]=0;
			for(k=0;k<3;k++){
				output[i][j]+=rotate[i][k]*input[k][j];
			}
		}
	}
}

float radian(float a)
{
return(a*(3.14/180));
}
void rotation()
{
 printf("Enter number of vertices: ");
    scanf("%d", &v);

    for (i = 0; i < v; i++) {
        printf("X[%d]: ", i);
        scanf("%f", &input[0][i]);
        printf("Y[%d]: ", i);
        scanf("%f", &input[1][i]);
        input[2][i] = 1;
    }
    printf("\n");
    for( i=0;i<3;i++)
    {
    for(j=0;j<v;j++)
    {
    printf("\t%f",input[i][j]);
    }
    printf("\n");
    }
    printf("\n");
    int xr,yr;
    float t;
    printf("Enter value of angle");
    scanf("%f",&t);
    printf("Reference points");
    scanf("%d%d",&xr,&yr);
    rotate[0][0]=cos(radian(t));
    rotate[0][1]=-sin(radian(t));
    rotate[0][2]=xr*(1-cos(radian(t)))+yr*sin(radian(t));
    
    rotate[1][0]=sin(radian(t));
    rotate[1][1]=cos(radian(t));
    rotate[1][2]=yr*(1-cos(radian(t)))-xr*sin(radian(t));
    
    rotate[2][0]=0;
    rotate[2][1]=0;
    rotate[2][2]=1;
    printf("\n");
    for( i=0;i<3;i++)
    {
    for(j=0;j<3;j++)
    {
    printf("\t%f",rotate[i][j]);
    }
    printf("\n");
    }
    mul(input,output,rotate,v);
    printf("\n");
    for(i=0;i<3;i++)
    {
    for(j=0;j<v;j++)
    {
    printf("\t%f",output[i][j]);
    }
    printf("\n");
    }
    }

void Bline(int xa,int ya,int xb,int yb)
{
		int dx,dy,d;
		int c,r,f;
		
		dx = xb - xa;
		dy = yb - ya;
	
	if(abs(dx) > abs(dy))
	{
	
		d = 2 * abs(dy) - abs(dx);
		
		if(dx>0)
		{
			c=xa;
			r=ya;
			f=xb;
		}
		else
		{
			c=xb;
			r=yb;
			f=xa;
		}
while(f > c)
		{
			if(d < 0)
			{
				c = c + 1;
				d= d + 2 * abs(dy);
			}
			else
			{
				c = c + 1;
				
				if(dx > 0 && dy > 0 || dx < 0 && dy < 0)
				{
					r = r + 1;
				}
				else
				{
					r = r - 1;
				}
				d = d + 2 * abs(dy) - 2 * abs(dx);
			}
			glVertex2d(c,r);			
	
		}
		
	}
	
	else
{
		d = 2 * abs(dx) - abs(dy);
		
		if(dy>0)
		{
			c=xa;
			r=ya;
			f=yb;
		}
		else
		{
			c=xb;
			r=yb;
			f=ya;
		}
		
		while(f > r)
		{
			if(d < 0)
			{
				r = r + 1;
				d= d + 2 * abs(dx);
			}
			else
			{
				r = r + 1;
				if(dx > 0 && dy > 0 || dx < 0 && dy < 0)
				{
					c = c + 1;
				}
				else
				{
					c = c - 1;
				}
				d = d + 2 * abs(dx) - 2 * abs(dy);
			}
			glVertex2d(c,r);			
	
		}
	}
}


void draw(){
	glClear(GL_COLOR_BUFFER_BIT);
	glBegin(GL_POINTS);
int i;
for(i=0;i<v-1;i++)
{
	Bline(input[0][i],input[1][i],input[0][i+1],input[1][i+1]);
}
Bline(input[0][i],input[1][i],input[0][0],input[1][0]);

for(i=0;i<v-1;i++)
{
	Bline(output[0][i],output[1][i],output[0][i+1],output[1][i+1]);
}
Bline(output[0][i],output[1][i],output[0][0],output[1][0]);
	glEnd();
	glFlush();
}

int main(int args,char**argv){
	rotation();
	/*printf("\nEnter First Coordinate: ");
		scanf("%d%d",&xa,&ya);
		
		printf("\nEnter Second Coordinate: ");
		scanf("%d%d",&xb,&yb);*/

	glutInit(& args,argv);
	glutInitDisplayMode(GLUT_SINGLE|GLUT_RGB);
	glutInitWindowPosition(0,0);
	glutInitWindowSize(640,480);
	glutCreateWindow("cg");
	glClearColor(1.0,1.0,1.0,0);
	glColor3f(0,0,0);
	gluOrtho2D(0,640,0,480);
	glutDisplayFunc(draw);
	glutMainLoop();
	return 0;
}
